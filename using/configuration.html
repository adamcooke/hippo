<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuring a stage | Hippo</title>
    <meta name="description" content="Kubernetes deployment toolkit">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/hippo/assets/css/0.styles.50f5afac.css" as="style"><link rel="preload" href="/hippo/assets/js/app.b04199ea.js" as="script"><link rel="preload" href="/hippo/assets/js/2.d83d8343.js" as="script"><link rel="preload" href="/hippo/assets/js/9.422d30b4.js" as="script"><link rel="prefetch" href="/hippo/assets/js/10.8a96ecc0.js"><link rel="prefetch" href="/hippo/assets/js/11.da559e82.js"><link rel="prefetch" href="/hippo/assets/js/12.5440a5fd.js"><link rel="prefetch" href="/hippo/assets/js/13.9248b3aa.js"><link rel="prefetch" href="/hippo/assets/js/14.b392259a.js"><link rel="prefetch" href="/hippo/assets/js/15.8a0c17a3.js"><link rel="prefetch" href="/hippo/assets/js/16.b4083c06.js"><link rel="prefetch" href="/hippo/assets/js/3.ed1d9c25.js"><link rel="prefetch" href="/hippo/assets/js/4.1551477e.js"><link rel="prefetch" href="/hippo/assets/js/5.9d20a555.js"><link rel="prefetch" href="/hippo/assets/js/6.27217335.js"><link rel="prefetch" href="/hippo/assets/js/7.0e4232b2.js"><link rel="prefetch" href="/hippo/assets/js/8.0692184c.js">
    <link rel="stylesheet" href="/hippo/assets/css/0.styles.50f5afac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hippo/" class="home-link router-link-active"><!----> <span class="site-name">Hippo</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hippo/" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="https://github.com/adamcooke/hippo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Code
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://slack.adam.ac" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Slack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hippo/" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="https://github.com/adamcooke/hippo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Code
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://slack.adam.ac" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Slack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hippo/" class="sidebar-link">Welcome to Hippo 🦛</a></li><li><a href="/hippo/install.html" class="sidebar-link">Installing</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Using Hippo</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hippo/using/" class="sidebar-link">Setting up</a></li><li><a href="/hippo/using/creating-a-stage.html" class="sidebar-link">Creating a stage</a></li><li><a href="/hippo/using/configuration.html" class="active sidebar-link">Configuring a stage</a></li><li><a href="/hippo/using/preparing.html" class="sidebar-link">Preparing the cluster</a></li><li><a href="/hippo/using/installing-the-application.html" class="sidebar-link">Installing the application</a></li><li><a href="/hippo/using/status.html" class="sidebar-link">Viewing application status</a></li><li><a href="/hippo/using/deploying-updates.html" class="sidebar-link">Deploying updates</a></li><li><a href="/hippo/using/console-and-commands.html" class="sidebar-link">Console and commands</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Writing manifests</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hippo/manifests/" class="sidebar-link">Application manifests</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="configuring-a-stage"><a href="#configuring-a-stage" class="header-anchor">#</a> Configuring a stage</h1> <p>Your stage configuration defines everything that's needed to run your application. This may include database connection details, API keys, hostnames and more.</p> <p>There are two types of configuration:</p> <ul><li><p><strong>Configuration</strong> - this is plain text configuration variables which are defined in <code>config.yaml</code></p></li> <li><p><strong>Secrets</strong> - these are encrypted values that are not stored in plain text in your configuration directory. They are encrypted using a private key that is available in the Kubernetes API.</p></li></ul> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>In addition to application specific configuration, there are also other values that you may wish to specify in here. This is an example <code>config.yaml</code>.</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> staging
<span class="token key atrule">namespace</span><span class="token punctuation">:</span> postal<span class="token punctuation">-</span>staging
<span class="token key atrule">context</span><span class="token punctuation">:</span> staging<span class="token punctuation">-</span>cluster
<span class="token key atrule">config</span><span class="token punctuation">:</span>
  <span class="token key atrule">hostname</span><span class="token punctuation">:</span> postal.mydomain.com
  <span class="token key atrule">storageClass</span><span class="token punctuation">:</span> nfs
  <span class="token key atrule">workers</span><span class="token punctuation">:</span>
    <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><strong>Line 1</strong> defines the name of the stage.</li> <li><strong>Line 2</strong> specifies the namespace that your application will be deployed into (each stage always should have its own unique namespace).</li> <li><strong>Line 3</strong> specifies the name of the kubectl context of the cluster you wish to connect to.</li> <li><strong>Lines 4 to 8</strong> contain application specific configuration.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Manifest authors can provide default values for the <code>config</code> section of this file so if you create your stage with <code>hippo [stage-name] create</code> this section may already contain some placeholder values for you to update.</p></div> <h2 id="secrets"><a href="#secrets" class="header-anchor">#</a> Secrets</h2> <p>Secrets exist to allow you to store private information as part of your stage. You do not want to be uploading API keys or passwords into repositories in plain text as this will pose a security risk.</p> <p>Hippo provides a utility that allows you to encrypt secrets into a file which can be committed. This is stored in the <code>secrets.yaml</code> file in your stage configuration directory.</p> <div class="custom-block danger"><p class="custom-block-title">A NOTE ABOUT THE PRIVATE KEY</p> <p>The private key that encrypts your secrets is stored on the Kubernetes API within a <code>Secret</code> named <code>hippo-secret-key</code> in the stage's namespace. Remember, secrets on Kubernetes are not that secret - they're just base64 encoded and available to anyone with API access to those resources in your namespace. This is usually fine because those with access to your API should also be permitted to read the secrets in this repository (and they likely can anyway through the Kubernetes API).</p></div> <h3 id="editting-secrets"><a href="#editting-secrets" class="header-anchor">#</a> Editting secrets</h3> <p>The <code>hippo [stage-name] secrets</code> utility command will decrypt the secrets, open the decrypted file in an editor and then encrypt it again when it closes.</p> <p>The secrets file itself is just YAML.</p> <p>As with configuration, the manifest author may have provided some default secrets which you may wish to change or review. In some cases, manifests may request that random values are provided automatically (for example it may generate a random database password which you don't need to change).</p> <div class="custom-block tip"><p class="custom-block-title">CHOOSING AN EDITOR</p> <p>Hippo will open the editor defined in the <code>EDITOR</code> environment variable so be sure to set this. I usually recommend <code>nano</code> for edits like this.</p></div> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hippo <span class="token punctuation">[</span>stage-name<span class="token punctuation">]</span> secrets
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="reviewing-configuration"><a href="#reviewing-configuration" class="header-anchor">#</a> Reviewing configuration</h2> <p>All configuration that is entered is exposed to your manifest through the Hippo templating system. For a full list of all variables which have been set, you can run the command below:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hippo <span class="token punctuation">[</span>stage-name<span class="token punctuation">]</span> vars
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hippo/using/creating-a-stage.html" class="prev">
        Creating a stage
      </a></span> <span class="next"><a href="/hippo/using/preparing.html">
        Preparing the cluster
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hippo/assets/js/app.b04199ea.js" defer></script><script src="/hippo/assets/js/2.d83d8343.js" defer></script><script src="/hippo/assets/js/9.422d30b4.js" defer></script>
  </body>
</html>
